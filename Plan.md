## План работ

- [x] Этап 1: Подготовка и обзор структуры
  - [x] Проверить дерево проекта и ключевые директории
  - [x] Определить основные точки входа и конфигурации
  - [x] Зафиксировать список файлов для чтения

- [x] Этап 2: Анализ модулей и связей
  - [x] Прочитать основные модули приложения
  - [x] Понять потоки данных и зависимости
  - [x] Выявить критические интеграции (БД/боты/файлы)

- [x] Этап 3: Итоговая сводка
  - [x] Сформировать краткое описание архитектуры
  - [x] Указать точки расширения и риски
  - [x] Предложить следующие шаги (тесты/рефакторинг)

- [x] Этап 4: Исправление авторизации
  - [x] Анализ новой структуры страницы авторизации
  - [x] Обновление селекторов в config.py (оставлены только рабочие селекторы)
  - [x] Обновление логики авторизации в auth_service.py с поддержкой data-testid и fallback-селекторов
  - [x] Добавление fallback-селекторов для надежности
  - [x] Улучшение логирования для диагностики
  - [x] Исправление проверки успешности авторизации (проверка по URL, заголовку и элементам страницы)
  - [x] Тестирование авторизации

- [x] Этап 5: Исправление получения заказов
  - [x] Обновление селекторов для поиска элементов заказов (использование data-testid для ссылок)
  - [x] Исправление обработки ссылок vs контейнеров заказов
  - [x] Улучшение поиска данных заказа в родительских контейнерах
  - [x] Исправление обработки stale element reference
  - [x] Улучшение обработки ошибок при получении заказов
  - [ ] Тестирование получения заказов

- [ ] Этап 6: Переход на плюс-слова в фильтрации
  - [x] Найти текущую логику минус-слов и точки использования фильтра
  - [x] Определить источник списка слов и формат хранения
  - [x] Реализовать фильтр по плюс-словам (регистр-независимо)
  - [x] Обновить логи/комментарии/документацию по новой логике
  - [x] Обновить конфиги/файлы слов для теста (adwords, Директ)
  - [x] Протестировать фильтрацию на примерах заголовка и описания

- [ ] Этап 7: Устранение stale element reference
  - [x] Определить места повторного доступа к DOM после рендера
  - [x] Добавить безопасное получение элемента по индексу и селектору
  - [x] Переподключить обработку заказов к безопасному элементу
  - [x] Обновить логи/комментарии по новой логике
  - [x] Увеличить SELENIUM_PAGE_LOAD_TIMEOUT для загрузки карточек
  - [x] Добавить 1 повтор для get_additional_info
  - [ ] Протестировать парсер на 1-2 проходах

- [ ] Этап 8: Прозрачная фильтрация и описание
  - [x] Показывать в сообщении matched плюс-слова
  - [x] Добавить fallback для описания из текста элемента
  - [x] Обновить логи/комментарии по новой логике
  - [x] Добавить диагностические логи для фильтрации
  - [ ] Протестировать отправку 1-2 заказов

- [ ] Этап 9: Таймаут загрузки страницы заказов
  - [x] Установить page load timeout перед переходом на страницу заказов
  - [x] Добавить обработку TimeoutException с мягким продолжением
  - [ ] Протестировать загрузку и парсинг заказов

- [ ] Этап 10: Временный возврат к минус-словам
  - [x] Переключить фильтрацию на excluded_words.txt
  - [x] Обновить логи/комментарии по новой логике
  - [ ] Протестировать получение 1-2 заказов
